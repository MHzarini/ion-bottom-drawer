{"version":3,"sources":["ng://ion-bottom-nav-drawer/lib/drawer-state.ts","ng://ion-bottom-nav-drawer/lib/ion-bottom-nav-drawer.component.ts","ng://ion-bottom-nav-drawer/lib/ion-bottom-nav-drawer.module.ts"],"names":["Bottom","Docked","Top","IonBottomNavDrawerComponent","_element","_renderer","_domCtrl","_platform","this","state","DrawerState","stateChange","EventEmitter","_BOUNCE_DELTA","dockedHeight","shouldBounce","disableDrag","distanceTop","transition","minimumHeight","prototype","ngAfterViewInit","_this","setStyle","nativeElement","querySelector","_setDrawerState","hammer","Hammer","get","set","enable","direction","Hammer.DIRECTION_VERTICAL","on","ev","type","_handlePanStart","_handlePanEnd","_handlePan","ngOnChanges","changes","currentValue","_setTranslateY","height","_startPositionTop","getBoundingClientRect","top","isFinal","_handleDockedPanEnd","_handleTopPanEnd","_handleBottomPanEnd","emit","deltaY","absDeltaY","Math","abs","pointerY","center","y","additionalEvent","newTop","value","write","Component","args","selector","template","ElementRef","Renderer2","DomController","Platform","Input","Output","IonBottomNavDrawerModule","NgModule","declarations","imports","IonicModule","exports"],"mappings":"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","sourcesContent":["export enum DrawerState {\r\n  Bottom,\r\n  Docked,\r\n  Top\r\n}\r\n","import {\r\n  AfterViewInit,\r\n  Component,\r\n  ElementRef,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  Output,\r\n  Renderer2,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { DomController, Platform } from '@ionic/angular';\r\nimport * as Hammer from 'hammerjs';\r\n\r\nimport { DrawerState } from './drawer-state';\r\n\r\n@Component({\r\n  selector: 'ion-bottom-nav-drawer',\r\n  templateUrl: './ion-bottom-nav-drawer.component.html',\r\n  styleUrls: ['./ion-bottom-nav-drawer.component.css'],\r\n})\r\nexport class IonBottomNavDrawerComponent implements AfterViewInit, OnChanges {\r\n\r\n  @Input() dockedHeight: number;\r\n\r\n  @Input() shouldBounce: boolean;\r\n\r\n  @Input() disableDrag: boolean;\r\n\r\n  @Input() distanceTop: number;\r\n\r\n  @Input() transition: string;\r\n\r\n  @Input() state: DrawerState = DrawerState.Bottom;\r\n\r\n  @Input() minimumHeight: number;\r\n\r\n  @Output() stateChange: EventEmitter<DrawerState> = new EventEmitter<DrawerState>();\r\n\r\n  private _startPositionTop: number;\r\n  private readonly _BOUNCE_DELTA = 30;\r\n\r\n  constructor(\r\n    private _element: ElementRef,\r\n    private _renderer: Renderer2,\r\n    private _domCtrl: DomController,\r\n    private _platform: Platform\r\n  ) {\r\n    this.dockedHeight = 50;\r\n    this.shouldBounce = true;\r\n    this.disableDrag = false;\r\n    this.distanceTop = 0;\r\n    this.transition = '0.25s ease-in-out';\r\n    this.minimumHeight = 0;\r\n    this.dockedHeight = 50;\r\n\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    this._renderer.setStyle(this._element.nativeElement.querySelector('.ion-bottom-drawer-scrollable-content :first-child'),\r\n      'touch-action', 'none');\r\n    this._setDrawerState(this.state);\r\n\r\n    const hammer = new Hammer(this._element.nativeElement);\r\n    hammer.get('pan').set({ enable: true, direction: Hammer.DIRECTION_VERTICAL });\r\n    hammer.on('pan panstart panend', (ev: any) => {\r\n      if (this.disableDrag) {\r\n        return;\r\n      }\r\n      switch (ev.type) {\r\n        case 'panstart':\r\n          this._handlePanStart();\r\n          break;\r\n        case 'panend':\r\n          this._handlePanEnd(ev);\r\n          break;\r\n        default:\r\n          this._handlePan(ev);\r\n      }\r\n    });\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (!changes.state) {\r\n      return;\r\n    }\r\n    this._setDrawerState(changes.state.currentValue);\r\n  }\r\n\r\n  private _setDrawerState(state: DrawerState) {\r\n    this._renderer.setStyle(this._element.nativeElement, 'transition', this.transition);\r\n    switch (state) {\r\n      case DrawerState.Bottom:\r\n        this._setTranslateY('calc(100vh - ' + this.minimumHeight + 'px)');\r\n        break;\r\n      case DrawerState.Docked:\r\n        this._setTranslateY((this._platform.height() - this.dockedHeight) + 'px');\r\n        break;\r\n      default:\r\n        this._setTranslateY(this.distanceTop + 'px');\r\n    }\r\n  }\r\n\r\n  private _handlePanStart() {\r\n    this._startPositionTop = this._element.nativeElement.getBoundingClientRect().top;\r\n  }\r\n\r\n  private _handlePanEnd(ev) {\r\n    if (this.shouldBounce && ev.isFinal) {\r\n      this._renderer.setStyle(this._element.nativeElement, 'transition', this.transition);\r\n\r\n      switch (this.state) {\r\n        case DrawerState.Docked:\r\n          this._handleDockedPanEnd(ev);\r\n          break;\r\n        case DrawerState.Top:\r\n          this._handleTopPanEnd(ev);\r\n          break;\r\n        default:\r\n          this._handleBottomPanEnd(ev);\r\n      }\r\n    }\r\n    this.stateChange.emit(this.state);\r\n  }\r\n\r\n  private _handleTopPanEnd(ev) {\r\n    if (ev.deltaY > this._BOUNCE_DELTA) {\r\n      this.state = DrawerState.Docked;\r\n    } else {\r\n      this._setTranslateY(this.distanceTop + 'px');\r\n    }\r\n  }\r\n\r\n  private _handleDockedPanEnd(ev) {\r\n    const absDeltaY = Math.abs(ev.deltaY);\r\n    if (absDeltaY > this._BOUNCE_DELTA && ev.deltaY < 0) {\r\n      this.state = DrawerState.Top;\r\n    } else if (absDeltaY > this._BOUNCE_DELTA && ev.deltaY > 0) {\r\n      this.state = DrawerState.Bottom;\r\n    } else {\r\n      this._setTranslateY((this._platform.height() - this.dockedHeight) + 'px');\r\n    }\r\n  }\r\n\r\n  private _handleBottomPanEnd(ev) {\r\n    if (-ev.deltaY > this._BOUNCE_DELTA) {\r\n      this.state = DrawerState.Docked;\r\n    } else {\r\n      this._setTranslateY('calc(100vh - ' + this.minimumHeight + 'px)');\r\n    }\r\n  }\r\n\r\n  private _handlePan(ev) {\r\n    const pointerY = ev.center.y;\r\n    this._renderer.setStyle(this._element.nativeElement, 'transition', 'none');\r\n    if (pointerY > 0 && pointerY < this._platform.height()) {\r\n      if (ev.additionalEvent === 'panup' || ev.additionalEvent === 'pandown') {\r\n        const newTop = this._startPositionTop + ev.deltaY;\r\n        if (newTop >= this.distanceTop) {\r\n          this._setTranslateY(newTop + 'px');\r\n        } else if (newTop < this.distanceTop) {\r\n          this._setTranslateY(this.distanceTop + 'px');\r\n        }\r\n        if (newTop > this._platform.height() - this.minimumHeight) {\r\n          this._setTranslateY((this._platform.height() - this.minimumHeight) + 'px');\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  private _setTranslateY(value) {\r\n    this._domCtrl.write(() => {\r\n      this._renderer.setStyle(this._element.nativeElement, 'transform', 'translateY(' + value + ')');\r\n    });\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { IonBottomNavDrawerComponent } from './ion-bottom-nav-drawer.component';\r\n\r\n@NgModule({\r\n  declarations: [IonBottomNavDrawerComponent],\r\n  imports: [IonicModule],\r\n  exports: [IonBottomNavDrawerComponent]\r\n})\r\nexport class IonBottomNavDrawerModule { }\r\n"]}